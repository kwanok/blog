{% set analytics_service = config.extra.analytics.service %}
{% set analytics_id = config.extra.analytics.id | default(value="") %}
{% set self_hosted_url = config.extra.analytics.self_hosted_url | default(value="") %}

{% if analytics_service == "goatcounter" %}
    <script>
        var t = setInterval(function() {
            if (window.goatcounter && window.goatcounter.visit_count) {
                clearInterval(t)
                window.goatcounter.visit_count({append: 'body'})
            }
        }, 100)
    </script>
    <script data-goatcounter="https://stats.kwanok.me/count"
            async src="//gc.zgo.at/count.js"></script>


{% elif analytics_service == "umami" %}
    <script async defer
    {% if self_hosted_url %}
        data-website-id="{{ analytics_id }}"
        src="{{ self_hosted_url ~ '/umami.js' }}"
    {% else %}
        data-website-id="{{ analytics_id }}"
        src="https://analytics.eu.umami.is/script.js"
    {% endif %}
    data-do-not-track="true">
    </script>

    {% elif analytics_service == "plausible" %}
    <script
        defer
        data-domain="{{ analytics_id }}"
        src="{% if self_hosted_url %}{{ self_hosted_url ~ '/js/plausible.js' }}{% else %}https://plausible.io/js/script.js{% endif %}"
    ></script>

{% endif %}
